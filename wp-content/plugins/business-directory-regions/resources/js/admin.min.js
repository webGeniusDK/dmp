var WPBDP;void 0!==jQuery&&(WPBDP=jQuery.WPBDP=jQuery.extend({},jQuery.WPBDP,WPBDP),function($){$.WPBDP.Regions=function(){},$.extend($.WPBDP.Regions.prototype,{onSuccess:function(callback){return function(response){response&&response.success&&$.isFunction(callback)&&callback(response)}}}),$("#wpcontent").addClass("wpbdp-regions"),$("#tag-description, #tag-slug, #_parent").closest(".form-field").hide(),$(function(){var regions=new $.WPBDP.Regions;$("#the-list").delegate(".enabled .row-actions a","click",function(event){event.preventDefault();var html,link=$(this),table=link.closest("table"),event=link.closest("span").attr("class"),id=parseInt(link.closest("tr").attr("id").replace("tag-",""),10),selectors={enabled:"span.enable, span.disable"};$.getJSON(ajaxurl,{action:"wpbdp-regions-"+event,region:id},regions.onSuccess(function(response){response.updated&&response.updated.length?$.each(response.updated,function(k,id){var column,content,row=table.find("#tag-"+id);for(column in html=response.html)html.hasOwnProperty(column)&&(content=html[column].replace(/tag_ID=\d+/,"tag_ID="+id),row.find(selectors[column]).closest("td").html(content))}):link.closest("td").html(response.html)}))}).delegate(".name .row-actions .add-child","click",function(event){event.preventDefault();var event=$(this).closest("tr"),id=event.attr("id").replace("tag-",""),tabs=$("#wpbdp-regions-tabs"),parentInput=tabs.find('[name="parent_name"]');tabs.find('[name="parent"]').val(id),parentInput.val(event.find("#inline_"+id+" .name").text()),event=tabs.find('[name="tag-name"]').filter(":visible").focus(),parentInput.add(event).stop().animate({backgroundColor:"#FFFBCC"}).animate({backgroundColor:"transparent"},3e3)}).delegate(".row-title","click",function(event){event.preventDefault();event=$(this).closest("td").find(".row-actions .children a");document.location=event.attr("href")}).delegate(".display-link","click",function(e){e.preventDefault();e=$(this).attr("href");prompt("URL:",e)})}),$(function(){var settings=$($.RegionsData.templates["settings-form"]),postbox=settings.find(".postbox"),settings=($("#wpbody-content .wrap").prepend(settings),postbox.addClass("closed").find(".handlediv").click(function(){postbox.toggleClass("closed")}),$($.RegionsData.templates["bulk-actions"]));settings.appendTo('select[name="action"]'),settings.clone().appendTo('select[name="action2"]');$($.RegionsData.templates.views).insertAfter(".wpbdp-content-area-body .search-form");var settings=$($.RegionsData.templates["add-regions-form"]),multiple=settings.find("form"),single=$("#addtag"),container=single.closest(".form-wrap"),multiple=[{field:multiple.find('input[name="parent"]'),display:multiple.find('input[name="parent_name"]')}];$.each(multiple,function(i,ac_field){ac_field.display.autocomplete({source:function(request,response){$.getJSON(ajaxurl,{action:"wpbdp-regions-admin-autocomplete",term:request.term},function(res){res.success&&response(res.data.items)})},select:function(event,ui){ui.item&&ac_field.field.val(ui.item.term_id)},focus:function(event,ui){$(".ui-autocomplete > li").attr("title","Region ID: "+ui.item.term_id+", Region Slug: "+ui.item.slug+(ui.item.parent?", Parent: "+ui.item.parent_name:""))}}),ac_field.display.focusout(function(e){""==$.trim($(this).val())&&ac_field.field.val(0)})}),container.append(settings),single.remove()})}(jQuery));